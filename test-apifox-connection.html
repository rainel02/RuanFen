<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Apifox è¿æ¥æµ‹è¯•</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .test-section {
      background: white;
      padding: 20px;
      margin: 20px 0;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    button {
      background: #1890ff;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #40a9ff;
    }
    .result {
      margin-top: 10px;
      padding: 10px;
      border-radius: 4px;
      white-space: pre-wrap;
      font-family: monospace;
      font-size: 12px;
    }
    .success {
      background: #f6ffed;
      border: 1px solid #b7eb8f;
      color: #389e0d;
    }
    .error {
      background: #fff2f0;
      border: 1px solid #ffccc7;
      color: #cf1322;
    }
    .info {
      background: #e6f7ff;
      border: 1px solid #91d5ff;
      color: #0958d9;
    }
  </style>
</head>
<body>
  <h1>ğŸ” Apifox è¿æ¥è¯Šæ–­å·¥å…·</h1>
  
  <div class="test-section">
    <h2>1. æ£€æŸ¥ Apifox Mock æœåŠ¡</h2>
    <p>æµ‹è¯•ç›´æ¥è¿æ¥åˆ° Apifox Mock æœåŠ¡ï¼ˆä¸é€šè¿‡ä»£ç†ï¼‰</p>
    <input type="text" id="apifoxUrl" placeholder="è¾“å…¥ä½ çš„ Apifox Mock åœ°å€ï¼Œä¾‹å¦‚: http://127.0.0.1:4523/m1/ä½ çš„é¡¹ç›®ID/api" style="width: 100%; padding: 8px; margin: 10px 0;">
    <button onclick="testDirectConnection()">æµ‹è¯•ç›´æ¥è¿æ¥</button>
    <div id="directResult" class="result"></div>
  </div>

  <div class="test-section">
    <h2>2. æ£€æŸ¥ Vite ä»£ç†</h2>
    <p>æµ‹è¯•é€šè¿‡ Vite ä»£ç†è¿æ¥ï¼ˆéœ€è¦å¼€å‘æœåŠ¡å™¨è¿è¡Œåœ¨ localhost:5173ï¼‰</p>
    <button onclick="testProxyConnection()">æµ‹è¯•ä»£ç†è¿æ¥</button>
    <div id="proxyResult" class="result"></div>
  </div>

  <div class="test-section">
    <h2>3. æµ‹è¯•ç™»å½•æ¥å£</h2>
    <p>æµ‹è¯•å®é™…çš„ç™»å½•æ¥å£ï¼ˆéœ€è¦é…ç½®æ­£ç¡®çš„é¡¹ç›® IDï¼‰</p>
    <button onclick="testLoginAPI()">æµ‹è¯•ç™»å½•æ¥å£</button>
    <div id="loginResult" class="result"></div>
  </div>

  <script>
    async function testDirectConnection() {
      const url = document.getElementById('apifoxUrl').value;
      const resultDiv = document.getElementById('directResult');
      
      if (!url) {
        resultDiv.className = 'result error';
        resultDiv.textContent = 'âŒ è¯·å…ˆè¾“å…¥ Apifox Mock åœ°å€';
        return;
      }

      resultDiv.className = 'result info';
      resultDiv.textContent = 'â³ æ­£åœ¨æµ‹è¯•...';

      try {
        // æµ‹è¯•ä¸€ä¸ªç®€å•çš„ GET è¯·æ±‚
        const testUrl = url.replace(/\/api$/, '') + '/auth/test';
        const response = await fetch(testUrl, {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json'
          }
        });

        resultDiv.className = 'result success';
        resultDiv.textContent = `âœ… è¿æ¥æˆåŠŸï¼\nçŠ¶æ€ç : ${response.status}\nURL: ${testUrl}\n\nå¦‚æœè¿”å› 404ï¼Œè¯´æ˜è·¯å¾„ä¸å¯¹ï¼Œä½†è‡³å°‘è¿æ¥æ˜¯é€šçš„ã€‚`;
      } catch (error) {
        resultDiv.className = 'result error';
        resultDiv.textContent = `âŒ è¿æ¥å¤±è´¥ï¼š\n${error.message}\n\nå¯èƒ½çš„åŸå› ï¼š\n1. Apifox Mock æœåŠ¡æœªå¯åŠ¨\n2. åœ°å€æˆ–ç«¯å£ä¸æ­£ç¡®\n3. ç½‘ç»œé—®é¢˜`;
      }
    }

    async function testProxyConnection() {
      const resultDiv = document.getElementById('proxyResult');
      resultDiv.className = 'result info';
      resultDiv.textContent = 'â³ æ­£åœ¨æµ‹è¯•...';

      try {
        const response = await fetch('http://localhost:5173/api/auth/test', {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json'
          }
        });

        resultDiv.className = 'result success';
        resultDiv.textContent = `âœ… ä»£ç†è¿æ¥æˆåŠŸï¼\nçŠ¶æ€ç : ${response.status}\n\nå¦‚æœè¿”å› 404ï¼Œè¯´æ˜ä»£ç†å·¥ä½œæ­£å¸¸ï¼Œä½†æ¥å£è·¯å¾„å¯èƒ½ä¸å¯¹ã€‚`;
      } catch (error) {
        resultDiv.className = 'result error';
        resultDiv.textContent = `âŒ ä»£ç†è¿æ¥å¤±è´¥ï¼š\n${error.message}\n\nå¯èƒ½çš„åŸå› ï¼š\n1. å¼€å‘æœåŠ¡å™¨æœªè¿è¡Œï¼ˆè¯·è¿è¡Œ npm run devï¼‰\n2. vite.config.ts ä¸­çš„é¡¹ç›® ID ä¸æ­£ç¡®\n3. Apifox Mock æœåŠ¡æœªå¯åŠ¨`;
      }
    }

    async function testLoginAPI() {
      const resultDiv = document.getElementById('loginResult');
      resultDiv.className = 'result info';
      resultDiv.textContent = 'â³ æ­£åœ¨æµ‹è¯•ç™»å½•æ¥å£...';

      try {
        const response = await fetch('http://localhost:5173/api/auth/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            account: 'test',
            password: 'test'
          })
        });

        const data = await response.json();
        
        if (response.ok) {
          resultDiv.className = 'result success';
          resultDiv.textContent = `âœ… ç™»å½•æ¥å£å“åº”æˆåŠŸï¼\nçŠ¶æ€ç : ${response.status}\nå“åº”æ•°æ®: ${JSON.stringify(data, null, 2)}`;
        } else {
          resultDiv.className = 'result error';
          resultDiv.textContent = `âš ï¸ æ¥å£è¿”å›é”™è¯¯ï¼š\nçŠ¶æ€ç : ${response.status}\nå“åº”: ${JSON.stringify(data, null, 2)}\n\nè¿™è‡³å°‘è¯´æ˜è¿æ¥æ˜¯é€šçš„ï¼Œåªæ˜¯æ¥å£é€»è¾‘è¿”å›äº†é”™è¯¯ã€‚`;
        }
      } catch (error) {
        resultDiv.className = 'result error';
        resultDiv.textContent = `âŒ è¯·æ±‚å¤±è´¥ï¼š\n${error.message}\n\nè¯·æ£€æŸ¥ï¼š\n1. å¼€å‘æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ\n2. vite.config.ts é…ç½®æ˜¯å¦æ­£ç¡®\n3. Apifox Mock æœåŠ¡æ˜¯å¦å¯åŠ¨`;
      }
    }
  </script>
</body>
</html>





